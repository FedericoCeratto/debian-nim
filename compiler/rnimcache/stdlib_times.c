/* Generated by Nim Compiler v0.13.0 */
/*   (c) 2015 Andreas Rumpf */
/* The generated code is subject to the original license. */
/* Compiled for: Linux, amd64, gcc */
/* Command for C compiler:
   gcc -c  -w -O3 -fno-strict-aliasing  -I/home/ubuntu/nim-ci/Nim/lib -o /home/ubuntu/nim-ci/Nim/compiler/rnimcache/stdlib_times.o /home/ubuntu/nim-ci/Nim/compiler/rnimcache/stdlib_times.c */
#define NIM_INTBITS 64

#include "nimbase.h"
#include <time.h>
#include <string.h>
#include <sys/select.h>
#include <sys/time.h>
typedef struct NimStringDesc NimStringDesc;
typedef struct TGenericSeq TGenericSeq;
typedef struct Timeinfo114804 Timeinfo114804;
typedef struct TNimObject TNimObject;
typedef struct TNimType TNimType;
typedef struct TNimNode TNimNode;
typedef struct Keyvaluepair152604 Keyvaluepair152604;
struct  TGenericSeq  {
NI len;
NI reserved;
};
struct  NimStringDesc  {
  TGenericSeq Sup;
NIM_CHAR data[SEQ_DECL_SIZE];
};
typedef N_NIMCALL_PTR(void, TY3489) (void* p, NI op);
typedef N_NIMCALL_PTR(void*, TY3494) (void* p);
struct  TNimType  {
NI size;
NU8 kind;
NU8 flags;
TNimType* base;
TNimNode* node;
void* finalizer;
TY3489 marker;
TY3494 deepcopy;
};
struct  TNimObject  {
TNimType* m_type;
};
struct  Timeinfo114804  {
  TNimObject Sup;
NI second;
NI minute;
NI hour;
NI monthday;
NU8 month;
NI year;
NU8 weekday;
NI yearday;
NIM_BOOL isdst;
NimStringDesc* tzname;
NI timezone;
};
struct  TNimNode  {
NU8 kind;
NI offset;
TNimType* typ;
NCSTRING name;
NI len;
TNimNode** sons;
};
typedef NU8 TY115652[7];
struct Keyvaluepair152604 {
NimStringDesc* Field0;
NimStringDesc* Field1;
};
N_NIMCALL(NI64, ntDiffTime)(time_t a, time_t b);
N_NIMCALL(void, getlocaltime_114839)(time_t t, Timeinfo114804* Result);
N_NIMCALL(void, tmtotimeinfo_115645)(struct tm* tm, NIM_BOOL local, Timeinfo114804* Result);
N_NIMCALL(void, gettzname_114887)(Keyvaluepair152604* Result);
N_NIMCALL(NimStringDesc*, cstrToNimstr)(NCSTRING str);
N_NIMCALL(void, unsureAsgnRef)(void** dest, void* src);
N_NIMCALL(NimStringDesc*, copyString)(NimStringDesc* src);
N_NIMCALL(NI, gettimezone_115001)(void);
N_NIMCALL(void, genericShallowAssign)(void* dest, void* src, TNimType* mt);
N_NOINLINE(void, chckNil)(void* p);
N_NIMCALL(void, genericReset)(void* dest, TNimType* mt);
N_NIMCALL(time_t, gettime_114837)(void);
N_NIMCALL(NimStringDesc*, nimIntToStr)(NI x);
static N_INLINE(void, appendString)(NimStringDesc* dest, NimStringDesc* src);
static N_INLINE(void, copymem_7478)(void* dest, void* source, NI size);
static N_INLINE(void, appendChar)(NimStringDesc* dest, NIM_CHAR c);
N_NIMCALL(NimStringDesc*, nsuIntToStr)(NI x, NI minchars);
N_NIMCALL(NimStringDesc*, rawNewString)(NI space);
NIM_CONST TY115652 weekdays_115650 = {((NU8) 6),
((NU8) 0),
((NU8) 1),
((NU8) 2),
((NU8) 3),
((NU8) 4),
((NU8) 5)}
;
STRING_LITERAL(TMP3482, "UTC", 3);
extern TNimType NTI3608; /* RootObj */
TNimType NTI114804; /* TimeInfo */
extern TNimType NTI104; /* int */
TNimType NTI114807; /* range 0..61(int) */
TNimType NTI114809; /* range 0..59(int) */
TNimType NTI114811; /* range 0..23(int) */
TNimType NTI114814; /* range 1..31(int) */
TNimType NTI114403; /* Month */
TNimType NTI114405; /* WeekDay */
TNimType NTI114819; /* range 0..365(int) */
extern TNimType NTI130; /* bool */
extern TNimType NTI138; /* string */

N_NIMCALL(NI64, ntDiffTime)(time_t a, time_t b) {
	NI64 result;
	NF LOC1;
{	result = 0;
	LOC1 = 0;
	LOC1 = difftime(a, b);
	result = float64ToInt64(LOC1);
	goto BeforeRet;
	}BeforeRet: ;
	return result;
}

N_NIMCALL(NIM_BOOL, ntEqTime)(time_t a, time_t b) {
	NIM_BOOL result;
	NI64 LOC1;
	result = 0;
	LOC1 = 0;
	LOC1 = ntDiffTime(a, b);
	result = (LOC1 == IL64(0));
	return result;
}

N_NIMCALL(void, gettzname_114887)(Keyvaluepair152604* Result) {
{	unsureAsgnRef((void**) (&(*Result).Field0), cstrToNimstr(tzname[(((NI) 0))- 0]));
	unsureAsgnRef((void**) (&(*Result).Field1), cstrToNimstr(tzname[(((NI) 1))- 0]));
	goto BeforeRet;
	}BeforeRet: ;
}

N_NIMCALL(NI, gettimezone_115001)(void) {
	NI result;
{	result = 0;
	result = timezone;
	goto BeforeRet;
	}BeforeRet: ;
	return result;
}

N_NIMCALL(void, tmtotimeinfo_115645)(struct tm* tm, NIM_BOOL local, Timeinfo114804* Result) {
	Timeinfo114804 LOC1;
	memset((void*)(&LOC1), 0, sizeof(LOC1));
	LOC1.Sup.m_type = (&NTI114804);
	memset((void*)(&LOC1), 0, sizeof(LOC1));
	LOC1.Sup.m_type = (&NTI114804);
	LOC1.second = ((NI) (((NI) ((*tm).tm_sec))));
	LOC1.minute = ((NI) (((NI) ((*tm).tm_min))));
	LOC1.hour = ((NI) (((NI) ((*tm).tm_hour))));
	LOC1.monthday = ((NI) (((NI) ((*tm).tm_mday))));
	LOC1.month = ((NU8) ((*tm).tm_mon));
	LOC1.year = ((NI) ((NI32)((*tm).tm_year + ((NI32) 1900))));
	LOC1.weekday = weekdays_115650[(((NI) ((*tm).tm_wday)))- 0];
	LOC1.yearday = ((NI) (((NI) ((*tm).tm_yday))));
	LOC1.isdst = (((NI32) 0) < (*tm).tm_isdst);
	{
		if (!local) goto LA4;
		{
			Keyvaluepair152604 LOC10;
			if (!(((NI32) 0) < (*tm).tm_isdst)) goto LA8;
			memset((void*)(&LOC10), 0, sizeof(LOC10));
			gettzname_114887((&LOC10));
			LOC1.tzname = copyString(LOC10.Field1);
		}
		goto LA6;
		LA8: ;
		{
			Keyvaluepair152604 LOC12;
			memset((void*)(&LOC12), 0, sizeof(LOC12));
			gettzname_114887((&LOC12));
			LOC1.tzname = copyString(LOC12.Field0);
		}
		LA6: ;
	}
	goto LA2;
	LA4: ;
	{
		LOC1.tzname = copyString(((NimStringDesc*) &TMP3482));
	}
	LA2: ;
	{
		if (!local) goto LA16;
		LOC1.timezone = gettimezone_115001();
	}
	goto LA14;
	LA16: ;
	{
		LOC1.timezone = ((NI) 0);
	}
	LA14: ;
	genericShallowAssign((void*)Result, (void*)(&LOC1), (&NTI114804));
}

N_NIMCALL(void, getlocaltime_114839)(time_t t, Timeinfo114804* Result) {
	time_t a;
	struct tm* lt;
	a = t;
	lt = localtime((&a));
	chckNil((void*)Result);
	genericReset((void*)Result, (&NTI114804));
	(*Result).Sup.m_type = (&NTI114804);
	tmtotimeinfo_115645((&(*lt)), NIM_TRUE, Result);
}

N_NIMCALL(time_t, gettime_114837)(void) {
	time_t result;
{	result = 0;
	result = time(NIM_NIL);
	goto BeforeRet;
	}BeforeRet: ;
	return result;
}

static N_INLINE(void, copymem_7478)(void* dest, void* source, NI size) {
	void* LOC1;
	LOC1 = 0;
	LOC1 = memcpy(dest, source, ((size_t) (size)));
}

static N_INLINE(void, appendString)(NimStringDesc* dest, NimStringDesc* src) {
	copymem_7478(((void*) ((&(*dest).data[((*dest).Sup.len)- 0]))), ((void*) ((*src).data)), ((NI) ((NI)((*src).Sup.len + ((NI) 1)))));
	(*dest).Sup.len += (*src).Sup.len;
}

static N_INLINE(void, appendChar)(NimStringDesc* dest, NIM_CHAR c) {
	(*dest).data[((*dest).Sup.len)- 0] = c;
	(*dest).data[((NI)((*dest).Sup.len + ((NI) 1)))- 0] = 0;
	(*dest).Sup.len += ((NI) 1);
}

N_NIMCALL(NimStringDesc*, ntgetDateStr)(void) {
	NimStringDesc* result;
	Timeinfo114804 ti;
	time_t LOC1;
	NimStringDesc* LOC2;
	NimStringDesc* LOC3;
	NimStringDesc* LOC4;
	NimStringDesc* LOC5;
	result = 0;
	memset((void*)(&ti), 0, sizeof(ti));
	ti.Sup.m_type = (&NTI114804);
	LOC1 = 0;
	LOC1 = gettime_114837();
	chckNil((void*)(&ti));
	memset((void*)(&ti), 0, sizeof(ti));
	ti.Sup.m_type = (&NTI114804);
	getlocaltime_114839(LOC1, (&ti));
	LOC2 = 0;
	LOC3 = 0;
	LOC3 = nimIntToStr(ti.year);
	LOC4 = 0;
	LOC4 = nsuIntToStr(((NI) ((NI)(((NI) (ti.month)) + ((NI) 1)))), ((NI) 2));
	LOC5 = 0;
	LOC5 = nsuIntToStr(((NI) (ti.monthday)), ((NI) 2));
	LOC2 = rawNewString(LOC3->Sup.len + LOC4->Sup.len + LOC5->Sup.len + 2);
appendString(LOC2, LOC3);
appendChar(LOC2, 45);
appendString(LOC2, LOC4);
appendChar(LOC2, 45);
appendString(LOC2, LOC5);
	result = LOC2;
	return result;
}

N_NIMCALL(NimStringDesc*, ntgetClockStr)(void) {
	NimStringDesc* result;
	Timeinfo114804 ti;
	time_t LOC1;
	NimStringDesc* LOC2;
	NimStringDesc* LOC3;
	NimStringDesc* LOC4;
	NimStringDesc* LOC5;
	result = 0;
	memset((void*)(&ti), 0, sizeof(ti));
	ti.Sup.m_type = (&NTI114804);
	LOC1 = 0;
	LOC1 = gettime_114837();
	chckNil((void*)(&ti));
	memset((void*)(&ti), 0, sizeof(ti));
	ti.Sup.m_type = (&NTI114804);
	getlocaltime_114839(LOC1, (&ti));
	LOC2 = 0;
	LOC3 = 0;
	LOC3 = nsuIntToStr(((NI) (ti.hour)), ((NI) 2));
	LOC4 = 0;
	LOC4 = nsuIntToStr(((NI) (ti.minute)), ((NI) 2));
	LOC5 = 0;
	LOC5 = nsuIntToStr(((NI) (ti.second)), ((NI) 2));
	LOC2 = rawNewString(LOC3->Sup.len + LOC4->Sup.len + LOC5->Sup.len + 2);
appendString(LOC2, LOC3);
appendChar(LOC2, 58);
appendString(LOC2, LOC4);
appendChar(LOC2, 58);
appendString(LOC2, LOC5);
	result = LOC2;
	return result;
}

N_NIMCALL(NF, toseconds_114859)(time_t time) {
	NF result;
	result = 0;
	result = ((NF) (time));
	return result;
}

N_NIMCALL(NF, ntepochTime)(void) {
	NF result;
	struct timeval a;
	result = 0;
	memset((void*)(&a), 0, sizeof(a));
	gettimeofday((&a), NIM_NIL);
	result = ((NF)(((double) (a.tv_sec))) + (NF)(((NF)(((double) (a.tv_usec))) * (NF)(9.9999999999999995e-07))));
	return result;
}
NIM_EXTERNC N_NOINLINE(void, stdlib_timesInit000)(void) {
	tzset();
}

NIM_EXTERNC N_NOINLINE(void, stdlib_timesDatInit000)(void) {
static TNimNode* TMP3475[11];
static TNimNode* TMP3476[12];
NI TMP3478;
static char* NIM_CONST TMP3477[12] = {
"mJan", 
"mFeb", 
"mMar", 
"mApr", 
"mMay", 
"mJun", 
"mJul", 
"mAug", 
"mSep", 
"mOct", 
"mNov", 
"mDec"};
static TNimNode* TMP3479[7];
NI TMP3481;
static char* NIM_CONST TMP3480[7] = {
"dMon", 
"dTue", 
"dWed", 
"dThu", 
"dFri", 
"dSat", 
"dSun"};
static TNimNode TMP17[33];
NTI114804.size = sizeof(Timeinfo114804);
NTI114804.kind = 17;
NTI114804.base = (&NTI3608);
TMP3475[0] = &TMP17[1];
NTI114807.size = sizeof(NI);
NTI114807.kind = 20;
NTI114807.base = (&NTI104);
NTI114807.flags = 3;
TMP17[1].kind = 1;
TMP17[1].offset = offsetof(Timeinfo114804, second);
TMP17[1].typ = (&NTI114807);
TMP17[1].name = "second";
TMP3475[1] = &TMP17[2];
NTI114809.size = sizeof(NI);
NTI114809.kind = 20;
NTI114809.base = (&NTI104);
NTI114809.flags = 3;
TMP17[2].kind = 1;
TMP17[2].offset = offsetof(Timeinfo114804, minute);
TMP17[2].typ = (&NTI114809);
TMP17[2].name = "minute";
TMP3475[2] = &TMP17[3];
NTI114811.size = sizeof(NI);
NTI114811.kind = 20;
NTI114811.base = (&NTI104);
NTI114811.flags = 3;
TMP17[3].kind = 1;
TMP17[3].offset = offsetof(Timeinfo114804, hour);
TMP17[3].typ = (&NTI114811);
TMP17[3].name = "hour";
TMP3475[3] = &TMP17[4];
NTI114814.size = sizeof(NI);
NTI114814.kind = 20;
NTI114814.base = (&NTI104);
NTI114814.flags = 3;
TMP17[4].kind = 1;
TMP17[4].offset = offsetof(Timeinfo114804, monthday);
TMP17[4].typ = (&NTI114814);
TMP17[4].name = "monthday";
TMP3475[4] = &TMP17[5];
NTI114403.size = sizeof(NU8);
NTI114403.kind = 14;
NTI114403.base = 0;
NTI114403.flags = 3;
for (TMP3478 = 0; TMP3478 < 12; TMP3478++) {
TMP17[TMP3478+6].kind = 1;
TMP17[TMP3478+6].offset = TMP3478;
TMP17[TMP3478+6].name = TMP3477[TMP3478];
TMP3476[TMP3478] = &TMP17[TMP3478+6];
}
TMP17[18].len = 12; TMP17[18].kind = 2; TMP17[18].sons = &TMP3476[0];
NTI114403.node = &TMP17[18];
TMP17[5].kind = 1;
TMP17[5].offset = offsetof(Timeinfo114804, month);
TMP17[5].typ = (&NTI114403);
TMP17[5].name = "month";
TMP3475[5] = &TMP17[19];
TMP17[19].kind = 1;
TMP17[19].offset = offsetof(Timeinfo114804, year);
TMP17[19].typ = (&NTI104);
TMP17[19].name = "year";
TMP3475[6] = &TMP17[20];
NTI114405.size = sizeof(NU8);
NTI114405.kind = 14;
NTI114405.base = 0;
NTI114405.flags = 3;
for (TMP3481 = 0; TMP3481 < 7; TMP3481++) {
TMP17[TMP3481+21].kind = 1;
TMP17[TMP3481+21].offset = TMP3481;
TMP17[TMP3481+21].name = TMP3480[TMP3481];
TMP3479[TMP3481] = &TMP17[TMP3481+21];
}
TMP17[28].len = 7; TMP17[28].kind = 2; TMP17[28].sons = &TMP3479[0];
NTI114405.node = &TMP17[28];
TMP17[20].kind = 1;
TMP17[20].offset = offsetof(Timeinfo114804, weekday);
TMP17[20].typ = (&NTI114405);
TMP17[20].name = "weekday";
TMP3475[7] = &TMP17[29];
NTI114819.size = sizeof(NI);
NTI114819.kind = 20;
NTI114819.base = (&NTI104);
NTI114819.flags = 3;
TMP17[29].kind = 1;
TMP17[29].offset = offsetof(Timeinfo114804, yearday);
TMP17[29].typ = (&NTI114819);
TMP17[29].name = "yearday";
TMP3475[8] = &TMP17[30];
TMP17[30].kind = 1;
TMP17[30].offset = offsetof(Timeinfo114804, isdst);
TMP17[30].typ = (&NTI130);
TMP17[30].name = "isDST";
TMP3475[9] = &TMP17[31];
TMP17[31].kind = 1;
TMP17[31].offset = offsetof(Timeinfo114804, tzname);
TMP17[31].typ = (&NTI138);
TMP17[31].name = "tzname";
TMP3475[10] = &TMP17[32];
TMP17[32].kind = 1;
TMP17[32].offset = offsetof(Timeinfo114804, timezone);
TMP17[32].typ = (&NTI104);
TMP17[32].name = "timezone";
TMP17[0].len = 11; TMP17[0].kind = 2; TMP17[0].sons = &TMP3475[0];
NTI114804.node = &TMP17[0];
}

