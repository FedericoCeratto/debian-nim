/* Generated by Nim Compiler v0.13.0 */
/*   (c) 2015 Andreas Rumpf */
/* The generated code is subject to the original license. */
/* Compiled for: Linux, amd64, gcc */
/* Command for C compiler:
   gcc -c  -w -O3 -fno-strict-aliasing  -I/home/ubuntu/nim-ci/Nim/lib -o /home/ubuntu/nim-ci/Nim/compiler/rnimcache/stdlib_securehash.o /home/ubuntu/nim-ci/Nim/compiler/rnimcache/stdlib_securehash.c */
#define NIM_INTBITS 64

#include "nimbase.h"
#include <string.h>
typedef struct TNimType TNimType;
typedef struct TNimNode TNimNode;
typedef struct NimStringDesc NimStringDesc;
typedef struct TGenericSeq TGenericSeq;
typedef N_NIMCALL_PTR(void, TY3489) (void* p, NI op);
typedef N_NIMCALL_PTR(void*, TY3494) (void* p);
struct  TNimType  {
NI size;
NU8 kind;
NU8 flags;
TNimType* base;
TNimNode* node;
void* finalizer;
TY3489 marker;
TY3494 deepcopy;
};
struct  TNimNode  {
NU8 kind;
NI offset;
TNimType* typ;
NCSTRING name;
NI len;
TNimNode** sons;
};
typedef NU8 Sha1digest202007[20];
struct  TGenericSeq  {
NI len;
NI reserved;
};
struct  NimStringDesc  {
  TGenericSeq Sup;
NIM_CHAR data[SEQ_DECL_SIZE];
};
typedef NU32 Sha1state202013[5];
typedef NU32 Sha1buffer202015[80];
N_NIMCALL(void, securehash_203339)(NimStringDesc* str, Sha1digest202007* Result);
N_NIMCALL(void, sha1_203096)(NimStringDesc* src, Sha1digest202007* Result);
N_NIMCALL(void, init_202028)(NU32* result);
N_NIMCALL(void, innerhash_202032)(NU32* state, NU32* w);
static N_INLINE(void, zeromem_7474)(void* p, NI size);
N_NOINLINE(void, chckNil)(void* p);
N_NIMCALL(void, genericReset)(void* dest, TNimType* mt);
N_NIMCALL(NimStringDesc*, readfile_14868)(NimStringDesc* filename);
N_NIMCALL(NIM_BOOL, HEX3DHEX3D_203421)(Sha1digest202007 x, Sha1digest202007 y);
N_NIMCALL(NI, nsuParseHexInt)(NimStringDesc* s);
static N_INLINE(void, appendChar)(NimStringDesc* dest, NIM_CHAR c);
N_NIMCALL(NimStringDesc*, rawNewString)(NI space);
N_NIMCALL(NimStringDesc*, copyString)(NimStringDesc* src);
N_NIMCALL(NimStringDesc*, nsuToHex)(NI64 x, NI len);
static N_INLINE(void, appendString)(NimStringDesc* dest, NimStringDesc* src);
static N_INLINE(void, copymem_7478)(void* dest, void* source, NI size);
N_NIMCALL(NimStringDesc*, resizeString)(NimStringDesc* dest, NI addlen);
STRING_LITERAL(TMP1837, "", 0);
extern TNimType NTI116; /* uint8 */
TNimType NTI202007; /* Sha1Digest */

N_NIMCALL(void, init_202028)(NU32* result) {
	result[(((NI) 0))- 0] = ((NU32) 1732584193);
	result[(((NI) 1))- 0] = ((NU32) IL64(4023233417));
	result[(((NI) 2))- 0] = ((NU32) IL64(2562383102));
	result[(((NI) 3))- 0] = ((NU32) 271733878);
	result[(((NI) 4))- 0] = ((NU32) IL64(3285377520));
}

N_NIMCALL(void, innerhash_202032)(NU32* state, NU32* w) {
	NU32 a;
	NU32 b;
	NU32 c;
	NU32 d;
	NU32 e;
	NI round;
	unsigned int v_202959;
	unsigned int v_202970;
	unsigned int v_202981;
	unsigned int v_202992;
	unsigned int v_203003;
	a = state[(((NI) 0))- 0];
	b = state[(((NI) 1))- 0];
	c = state[(((NI) 2))- 0];
	d = state[(((NI) 3))- 0];
	e = state[(((NI) 4))- 0];
	round = ((NI) 0);
	{
		while (1) {
			unsigned int t_202121;
			if (!(round < ((NI) 16))) goto LA2;
			t_202121 = (unsigned int)((NU32)((unsigned int)((NU32)((unsigned int)((NU32)((unsigned int)((NU32)((unsigned int)((NU32)((NU64)(a) << (NU64)(((NI) 5))) | (NU32)((NU64)(a) >> (NU64)(((NI) 27))))) + (NU32)((unsigned int)((unsigned int)(b & c) | (unsigned int)((unsigned int)((NU32) ~(b)) & d))))) + (NU32)(e))) + (NU32)(((NU32) 1518500249)))) + (NU32)(w[(round)- 0]));
			e = d;
			d = c;
			c = (unsigned int)((NU32)((NU64)(b) << (NU64)(((NI) 30))) | (NU32)((NU64)(b) >> (NU64)(((NI) 2))));
			b = a;
			a = t_202121;
			round += ((NI) 1);
		} LA2: ;
	}
	{
		while (1) {
			unsigned int t_202311;
			if (!(round < ((NI) 20))) goto LA4;
			w[(round)- 0] = (unsigned int)((NU32)((NU64)((NU32)((NU32)((NU32)(w[((NI)(round - ((NI) 3)))- 0] ^ w[((NI)(round - ((NI) 8)))- 0]) ^ w[((NI)(round - ((NI) 14)))- 0]) ^ w[((NI)(round - ((NI) 16)))- 0])) << (NU64)(((NI) 1))) | (NU32)((NU64)((NU32)((NU32)((NU32)(w[((NI)(round - ((NI) 3)))- 0] ^ w[((NI)(round - ((NI) 8)))- 0]) ^ w[((NI)(round - ((NI) 14)))- 0]) ^ w[((NI)(round - ((NI) 16)))- 0])) >> (NU64)(((NI) 31))));
			t_202311 = (unsigned int)((NU32)((unsigned int)((NU32)((unsigned int)((NU32)((unsigned int)((NU32)((unsigned int)((NU32)((NU64)(a) << (NU64)(((NI) 5))) | (NU32)((NU64)(a) >> (NU64)(((NI) 27))))) + (NU32)((unsigned int)((unsigned int)(b & c) | (unsigned int)((unsigned int)((NU32) ~(b)) & d))))) + (NU32)(e))) + (NU32)(((NU32) 1518500249)))) + (NU32)(w[(round)- 0]));
			e = d;
			d = c;
			c = (unsigned int)((NU32)((NU64)(b) << (NU64)(((NI) 30))) | (NU32)((NU64)(b) >> (NU64)(((NI) 2))));
			b = a;
			a = t_202311;
			round += ((NI) 1);
		} LA4: ;
	}
	{
		while (1) {
			unsigned int t_202484;
			if (!(round < ((NI) 40))) goto LA6;
			w[(round)- 0] = (unsigned int)((NU32)((NU64)((NU32)((NU32)((NU32)(w[((NI)(round - ((NI) 3)))- 0] ^ w[((NI)(round - ((NI) 8)))- 0]) ^ w[((NI)(round - ((NI) 14)))- 0]) ^ w[((NI)(round - ((NI) 16)))- 0])) << (NU64)(((NI) 1))) | (NU32)((NU64)((NU32)((NU32)((NU32)(w[((NI)(round - ((NI) 3)))- 0] ^ w[((NI)(round - ((NI) 8)))- 0]) ^ w[((NI)(round - ((NI) 14)))- 0]) ^ w[((NI)(round - ((NI) 16)))- 0])) >> (NU64)(((NI) 31))));
			t_202484 = (unsigned int)((NU32)((unsigned int)((NU32)((unsigned int)((NU32)((unsigned int)((NU32)((unsigned int)((NU32)((NU64)(a) << (NU64)(((NI) 5))) | (NU32)((NU64)(a) >> (NU64)(((NI) 27))))) + (NU32)((NU32)((NU32)(b ^ c) ^ d)))) + (NU32)(e))) + (NU32)(((NU32) 1859775393)))) + (NU32)(w[(round)- 0]));
			e = d;
			d = c;
			c = (unsigned int)((NU32)((NU64)(b) << (NU64)(((NI) 30))) | (NU32)((NU64)(b) >> (NU64)(((NI) 2))));
			b = a;
			a = t_202484;
			round += ((NI) 1);
		} LA6: ;
	}
	{
		while (1) {
			unsigned int t_202684;
			if (!(round < ((NI) 60))) goto LA8;
			w[(round)- 0] = (unsigned int)((NU32)((NU64)((NU32)((NU32)((NU32)(w[((NI)(round - ((NI) 3)))- 0] ^ w[((NI)(round - ((NI) 8)))- 0]) ^ w[((NI)(round - ((NI) 14)))- 0]) ^ w[((NI)(round - ((NI) 16)))- 0])) << (NU64)(((NI) 1))) | (NU32)((NU64)((NU32)((NU32)((NU32)(w[((NI)(round - ((NI) 3)))- 0] ^ w[((NI)(round - ((NI) 8)))- 0]) ^ w[((NI)(round - ((NI) 14)))- 0]) ^ w[((NI)(round - ((NI) 16)))- 0])) >> (NU64)(((NI) 31))));
			t_202684 = (unsigned int)((NU32)((unsigned int)((NU32)((unsigned int)((NU32)((unsigned int)((NU32)((unsigned int)((NU32)((NU64)(a) << (NU64)(((NI) 5))) | (NU32)((NU64)(a) >> (NU64)(((NI) 27))))) + (NU32)((unsigned int)((unsigned int)((unsigned int)(b & c) | (unsigned int)(b & d)) | (unsigned int)(c & d))))) + (NU32)(e))) + (NU32)(((NU32) IL64(2400959708))))) + (NU32)(w[(round)- 0]));
			e = d;
			d = c;
			c = (unsigned int)((NU32)((NU64)(b) << (NU64)(((NI) 30))) | (NU32)((NU64)(b) >> (NU64)(((NI) 2))));
			b = a;
			a = t_202684;
			round += ((NI) 1);
		} LA8: ;
	}
	{
		while (1) {
			unsigned int t_202858;
			if (!(round < ((NI) 80))) goto LA10;
			w[(round)- 0] = (unsigned int)((NU32)((NU64)((NU32)((NU32)((NU32)(w[((NI)(round - ((NI) 3)))- 0] ^ w[((NI)(round - ((NI) 8)))- 0]) ^ w[((NI)(round - ((NI) 14)))- 0]) ^ w[((NI)(round - ((NI) 16)))- 0])) << (NU64)(((NI) 1))) | (NU32)((NU64)((NU32)((NU32)((NU32)(w[((NI)(round - ((NI) 3)))- 0] ^ w[((NI)(round - ((NI) 8)))- 0]) ^ w[((NI)(round - ((NI) 14)))- 0]) ^ w[((NI)(round - ((NI) 16)))- 0])) >> (NU64)(((NI) 31))));
			t_202858 = (unsigned int)((NU32)((unsigned int)((NU32)((unsigned int)((NU32)((unsigned int)((NU32)((unsigned int)((NU32)((NU64)(a) << (NU64)(((NI) 5))) | (NU32)((NU64)(a) >> (NU64)(((NI) 27))))) + (NU32)((NU32)((NU32)(b ^ c) ^ d)))) + (NU32)(e))) + (NU32)(((NU32) IL64(3395469782))))) + (NU32)(w[(round)- 0]));
			e = d;
			d = c;
			c = (unsigned int)((NU32)((NU64)(b) << (NU64)(((NI) 30))) | (NU32)((NU64)(b) >> (NU64)(((NI) 2))));
			b = a;
			a = t_202858;
			round += ((NI) 1);
		} LA10: ;
	}
	v_202959 = (unsigned int)((NU32)(state[(((NI) 0))- 0]) + (NU32)(a));
	state[(((NI) 0))- 0] = v_202959;
	v_202970 = (unsigned int)((NU32)(state[(((NI) 1))- 0]) + (NU32)(b));
	state[(((NI) 1))- 0] = v_202970;
	v_202981 = (unsigned int)((NU32)(state[(((NI) 2))- 0]) + (NU32)(c));
	state[(((NI) 2))- 0] = v_202981;
	v_202992 = (unsigned int)((NU32)(state[(((NI) 3))- 0]) + (NU32)(d));
	state[(((NI) 3))- 0] = v_202992;
	v_203003 = (unsigned int)((NU32)(state[(((NI) 4))- 0]) + (NU32)(e));
	state[(((NI) 4))- 0] = v_203003;
}

static N_INLINE(void, zeromem_7474)(void* p, NI size) {
	void* LOC1;
	LOC1 = 0;
	LOC1 = memset(p, ((int) 0), ((size_t) (size)));
}

N_NIMCALL(void, sha1_203096)(NimStringDesc* src, Sha1digest202007* Result) {
	Sha1state202013 state_203101;
	Sha1buffer202015 w_203103;
	NI bytelen_203105;
	NI endoffullblocks_203107;
	NI endcurrentblock_203109;
	NI currentblock_203111;
	NI lastblockbytes_203115;
	memset((void*)state_203101, 0, sizeof(state_203101));
	init_202028(state_203101);
	memset((void*)w_203103, 0, sizeof(w_203103));
	bytelen_203105 = (src ? src->Sup.len : 0);
	endoffullblocks_203107 = (NI)(bytelen_203105 - ((NI) 64));
	endcurrentblock_203109 = ((NI) 0);
	currentblock_203111 = ((NI) 0);
	{
		while (1) {
			NI i_203113;
			if (!(currentblock_203111 <= endoffullblocks_203107)) goto LA2;
			endcurrentblock_203109 = (NI)(currentblock_203111 + ((NI) 64));
			i_203113 = ((NI) 0);
			{
				while (1) {
					if (!(currentblock_203111 < endcurrentblock_203109)) goto LA4;
					w_203103[(i_203113)- 0] = (unsigned int)((unsigned int)((unsigned int)(((NU32) (((NU8)(src->data[(NI)(currentblock_203111 + ((NI) 3))])))) | (NU32)((NU32)(((NU32) (((NU8)(src->data[(NI)(currentblock_203111 + ((NI) 2))]))))) << (NU32)(((NU32) 8)))) | (NU32)((NU32)(((NU32) (((NU8)(src->data[(NI)(currentblock_203111 + ((NI) 1))]))))) << (NU32)(((NU32) 16)))) | (NU32)((NU32)(((NU32) (((NU8)(src->data[currentblock_203111]))))) << (NU32)(((NU32) 24))));
					currentblock_203111 += ((NI) 4);
					i_203113 += ((NI) 1);
				} LA4: ;
			}
			innerhash_202032(state_203101, w_203103);
		} LA2: ;
	}
	endcurrentblock_203109 = (NI)(bytelen_203105 - currentblock_203111);
	zeromem_7474(((void*) (w_203103)), ((NI) 64));
	lastblockbytes_203115 = ((NI) 0);
	{
		while (1) {
			NU32 value_203117;
			if (!(lastblockbytes_203115 < endcurrentblock_203109)) goto LA6;
			value_203117 = (NU32)((NU32)(((NU32) (((NU8)(src->data[(NI)(lastblockbytes_203115 + currentblock_203111)]))))) << (NU32)((NU32)((NU64)((NU32)((NU32)(((NU32) 3)) - (NU32)(((NU32) ((NI)(lastblockbytes_203115 & ((NI) 3))))))) << (NU64)(((NI) 3)))));
			w_203103[((NI)((NU64)(lastblockbytes_203115) >> (NU64)(((NI) 2))))- 0] = (unsigned int)(w_203103[((NI)((NU64)(lastblockbytes_203115) >> (NU64)(((NI) 2))))- 0] | value_203117);
			lastblockbytes_203115 += ((NI) 1);
		} LA6: ;
	}
	w_203103[((NI)((NU64)(lastblockbytes_203115) >> (NU64)(((NI) 2))))- 0] = (unsigned int)(w_203103[((NI)((NU64)(lastblockbytes_203115) >> (NU64)(((NI) 2))))- 0] | (NU32)((NU32)(((NU32) 128)) << (NU32)((NU32)((NU64)((NU32)((NU32)(((NU32) 3)) - (NU32)(((NU32) ((NI)(lastblockbytes_203115 & ((NI) 3))))))) << (NU64)(((NI) 3))))));
	{
		if (!(((NI) 56) <= endcurrentblock_203109)) goto LA9;
		innerhash_202032(state_203101, w_203103);
		zeromem_7474(((void*) (w_203103)), ((NI) 64));
	}
	LA9: ;
	w_203103[(((NI) 15))- 0] = (NU32)((NU64)(((NU32) (bytelen_203105))) << (NU64)(((NI) 3)));
	innerhash_202032(state_203101, w_203103);
	{
		NI i_203119;
		NI res_203335;
		i_203119 = 0;
		res_203335 = ((NI) 0);
		{
			while (1) {
				if (!(res_203335 <= ((NI) 19))) goto LA13;
				i_203119 = res_203335;
				(*Result)[(i_203119)- 0] = ((NU8) ((NI)((NI)((NU64)(((NI) (state_203101[((NI)((NU64)(i_203119) >> (NU64)(((NI) 2))))- 0]))) >> (NU64)((NI)((NI)(((NI) 3) - ((NI) ((NI)(i_203119 & ((NI) 3))))) * ((NI) 8)))) & ((NI) 255))));
				res_203335 += ((NI) 1);
			} LA13: ;
		}
	}
}

N_NIMCALL(void, securehash_203339)(NimStringDesc* str, Sha1digest202007* Result) {
	chckNil((void*)Result);
	genericReset((void*)Result, (&NTI202007));
	sha1_203096(str, Result);
}

N_NIMCALL(void, securehashfile_203344)(NimStringDesc* filename, Sha1digest202007* Result) {
	NimStringDesc* LOC1;
	LOC1 = 0;
	LOC1 = readfile_14868(filename);
	chckNil((void*)Result);
	genericReset((void*)Result, (&NTI202007));
	securehash_203339(LOC1, Result);
}

N_NIMCALL(NIM_BOOL, HEX3DHEX3D_203415)(Sha1digest202007 a, Sha1digest202007 b) {
	NIM_BOOL result;
	result = 0;
	result = HEX3DHEX3D_203421(a, b);
	return result;
}

static N_INLINE(void, appendChar)(NimStringDesc* dest, NIM_CHAR c) {
	(*dest).data[((*dest).Sup.len)- 0] = c;
	(*dest).data[((NI)((*dest).Sup.len + ((NI) 1)))- 0] = 0;
	(*dest).Sup.len += ((NI) 1);
}

N_NIMCALL(void, parsesecurehash_203386)(NimStringDesc* hash, Sha1digest202007* Result) {
	{
		NI i_203407;
		NI res_203411;
		i_203407 = 0;
		res_203411 = ((NI) 0);
		{
			while (1) {
				NimStringDesc* LOC4;
				NI LOC5;
				if (!(res_203411 <= ((NI) 19))) goto LA3;
				i_203407 = res_203411;
				LOC4 = 0;
				LOC4 = rawNewString(2);
appendChar(LOC4, hash->data[(NI)(i_203407 * ((NI) 2))]);
appendChar(LOC4, hash->data[(NI)((NI)(i_203407 * ((NI) 2)) + ((NI) 1))]);
				LOC5 = 0;
				LOC5 = nsuParseHexInt(LOC4);
				(*Result)[(i_203407)- 0] = ((NU8) (LOC5));
				res_203411 += ((NI) 1);
			} LA3: ;
		}
	}
}

static N_INLINE(void, copymem_7478)(void* dest, void* source, NI size) {
	void* LOC1;
	LOC1 = 0;
	LOC1 = memcpy(dest, source, ((size_t) (size)));
}

static N_INLINE(void, appendString)(NimStringDesc* dest, NimStringDesc* src) {
	copymem_7478(((void*) ((&(*dest).data[((*dest).Sup.len)- 0]))), ((void*) ((*src).data)), ((NI) ((NI)((*src).Sup.len + ((NI) 1)))));
	(*dest).Sup.len += (*src).Sup.len;
}

N_NIMCALL(NimStringDesc*, HEX24_203348)(Sha1digest202007 self) {
	NimStringDesc* result;
	result = 0;
	result = copyString(((NimStringDesc*) &TMP1837));
	{
		NU8 v_203378;
		Sha1digest202007 HEX3Atmp_203382;
		NI i_203385;
		v_203378 = 0;
		memset((void*)HEX3Atmp_203382, 0, sizeof(HEX3Atmp_203382));
		memcpy((void*)HEX3Atmp_203382, (NIM_CONST void*)self, sizeof(Sha1digest202007));
		i_203385 = ((NI) 0);
		{
			if (!(((NI) (i_203385)) <= ((NI) 19))) goto LA4;
			{
				while (1) {
					NimStringDesc* LOC8;
					v_203378 = HEX3Atmp_203382[(i_203385)- 0];
					LOC8 = 0;
					LOC8 = nsuToHex(((NI64) (((NI) (v_203378)))), ((NI) 2));
					result = resizeString(result, LOC8->Sup.len + 0);
appendString(result, LOC8);
					{
						if (!(((NI) 19) <= ((NI) (i_203385)))) goto LA11;
						goto LA6;
					}
					LA11: ;
					i_203385 += ((NI) 1);
				}
			} LA6: ;
		}
		LA4: ;
	}
	return result;
}
NIM_EXTERNC N_NOINLINE(void, stdlib_securehashInit000)(void) {
}

NIM_EXTERNC N_NOINLINE(void, stdlib_securehashDatInit000)(void) {
NTI202007.size = sizeof(Sha1digest202007);
NTI202007.kind = 16;
NTI202007.base = (&NTI116);
NTI202007.flags = 3;
}

